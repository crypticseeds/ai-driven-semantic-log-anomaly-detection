[PARSER]
    Name        json
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On

[PARSER]
    Name        syslog
    Format      regex
    Regex       ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S
    Time_Keep   On

# Python multiline stack trace parser
# Matches: ERROR:module:message or similar Python log format
[PARSER]
    Name        python
    Format      regex
    Regex       ^(?<level>DEBUG|INFO|WARNING|ERROR|CRITICAL):(?<module>[^:]+):(?<message>.*)$
    Time_Keep   On

# Multiline parser for Python tracebacks
# Groups lines starting with "Traceback", "  File", "    ", or exception names
[MULTILINE_PARSER]
    Name          python_multiline
    Type          regex
    Flush_timeout 1000
    # Start of a new log entry - matches Python log format or Traceback
    Rule          "start_state"  "/^(DEBUG|INFO|WARNING|ERROR|CRITICAL):|^Traceback \(most recent call last\):/"  "cont"
    # Continuation lines - indented lines, "File" lines, exception lines
    Rule          "cont"         "/^(\s+|File |[A-Za-z_][A-Za-z0-9_]*(\.[A-Za-z_][A-Za-z0-9_]*)*Error:|[A-Za-z_][A-Za-z0-9_]*(\.[A-Za-z_][A-Za-z0-9_]*)*Exception:|The above exception|During handling)/"  "cont"

# Docker container log multiline parser (for JSON logs with multiline content)
[MULTILINE_PARSER]
    Name          docker_multiline
    Type          regex
    Flush_timeout 1000
    # Start with timestamp or log level
    Rule          "start_state"  "/^(\d{4}-\d{2}-\d{2}|\[?\d{2}:\d{2}:\d{2}|DEBUG|INFO|WARNING|ERROR|CRITICAL|Traceback)/"  "cont"
    # Continuation: indented lines, File references, exception chains
    Rule          "cont"         "/^(\s+|File |[A-Za-z_][A-Za-z0-9_.]*Error:|[A-Za-z_][A-Za-z0-9_.]*Exception:|The above exception|During handling|\|)/"  "cont"

[PARSER]
    Name        nginx
    Format      regex
    Regex       ^(?<remote>[^ ]*) (?<host>[^ ]*) (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)?" (?<code>[^ ]*) (?<size>[^ ]*)(?: "(?<referer>[^\"]*)" "(?<agent>[^\"]*)")?.*$
    Time_Key    time
    Time_Format %d/%b/%Y:%H:%M:%S %z
    Time_Keep   On

[PARSER]
    Name        opentelemetry
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep   On

[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On
